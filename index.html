<!doctype html>
<html lang="en-GB">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Stories of Amazement</title>
  <meta name="description" content="Short reflections, images, audio and playlists about human amazement and connection." />

  <link rel="canonical" href="https://your-domain.example/" />
  <meta name="theme-color" content="#000000" />

  <meta property="og:type" content="website" />
  <meta property="og:title" content="Stories of Amazement" />
  <meta property="og:description" content="Short reflections, images, audio and playlists about human amazement and connection." />
  <meta property="og:image" content="https://your-domain.example/og-cover.jpg" />
  <meta property="og:url" content="https://your-domain.example/" />

  <meta name="twitter:card" content="summary_large_image" />
  <meta name="robots" content="index, follow" />

  <link rel="preconnect" href="https://open.spotify.com" crossorigin>
  <link rel="preconnect" href="https://i.scdn.co" crossorigin>

  <!-- Preload hero for quicker first paint -->
  <link rel="preload" as="image" href="media/hero_hands.png">

  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    :root{
      --accent: #ff7900;
      --bg: #000;
      --text-weak: #9ca3af;
      --ease-quick: cubic-bezier(.2,.9,.3,1);
      --dur-short: 160ms;
      --dur-med: 280ms;
      --card-shadow: 0 22px 45px rgba(0,0,0,.65);
    }

    @media (prefers-reduced-motion: reduce) {
      * { transition: none !important; animation: none !important; scroll-behavior: auto !important; }
    }

    .btn {
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap:0.5rem;
      background:var(--accent);
      color:#000;
      padding:.6rem 1rem;
      border-radius:10px;
      font-weight:600;
      transition: transform var(--dur-short) var(--ease-quick), box-shadow var(--dur-short) var(--ease-quick), background var(--dur-short) var(--ease-quick);
      will-change: transform;
      text-decoration:none;
      box-shadow: 0 6px 14px rgba(0,0,0,0.18);
    }
    .btn:hover { transform: translateY(-3px) scale(1.008); }
    .btn:active { transform: translateY(0) scale(.998); }
    .btn:focus { outline: 3px solid rgba(255,121,0,0.18); outline-offset: 4px; }

    header { -webkit-tap-highlight-color: transparent; transition: transform .28s cubic-bezier(.2,.9,.3,1); }
    header.hidden-up { transform: translateY(-110%); }
    header.revealed { transform: translateY(0); }

    .nav-link { color: #e5e7eb; transition: color var(--dur-short) var(--ease-quick), transform var(--dur-short) var(--ease-quick); }
    .nav-link:hover, .nav-link:focus { color: #fff; transform: translateY(-2px); }

    #mobileNav {
      overflow: hidden;
      transition: max-height var(--dur-med) var(--ease-quick), opacity var(--dur-med) var(--ease-quick);
      max-height: 0;
      opacity: 0;
    }
    #mobileNav.open { max-height: 420px; opacity: 1; }

    .hero-bg {
      transition: transform 420ms var(--ease-quick), opacity 420ms var(--ease-quick);
      will-change: transform, opacity;
    }
    #heroTitle { line-height: 1.02; }
    .hero-inner { transform-origin: center; transition: transform 320ms var(--ease-quick); }

    .reveal {
      opacity: 0;
      transform: translateY(12px);
      transition: opacity .5s var(--ease-quick), transform .5s var(--ease-quick);
      will-change: transform, opacity;
    }
    .reveal.is-visible { opacity: 1; transform: translateY(0); }

    .fade-in { opacity: 0; transform: translateY(6px); transition: opacity .45s var(--ease-quick), transform .45s var(--ease-quick); }
    .fade-in.show { opacity: 1; transform: translateY(0); }

    .playlist-card {
      transition: transform 0.25s var(--ease-quick), box-shadow 0.25s var(--ease-quick), border-color 0.25s var(--ease-quick);
      border-width: 1px;
      border-style: solid;
      border-color: rgba(255, 121, 0, 0.15);
      box-shadow: 0 0 0 rgba(0, 0, 0, 0);
      position: relative;
      overflow: hidden;
      background: linear-gradient(180deg, rgba(0,0,0,0.45), rgba(0,0,0,0.35));
    }
    .playlist-card:hover { transform: translateY(-6px); box-shadow: var(--card-shadow); border-color: rgba(255, 121, 0, 0.8); }

    .iframe-skeleton {
      position: absolute;
      inset: 0;
      display: block;
      background: linear-gradient(90deg, rgba(255,255,255,0.03), rgba(255,255,255,0.06), rgba(255,255,255,0.03));
      background-size: 200% 100%;
      animation: shimmer 1.1s linear infinite;
      z-index: 5;
    }
    @keyframes shimmer {
      0% { background-position: 200% 0; }
      100% { background-position: -200% 0; }
    }

    .blur-up { filter: blur(14px) scale(1.02); transition: filter .6s var(--ease-quick), transform .6s var(--ease-quick), opacity .6s var(--ease-quick); will-change: filter, opacity, transform; }
    .img-loaded { filter: blur(0) scale(1); }

    #lightbox { opacity: 0; transition: opacity 240ms var(--ease-quick); }
    #lightbox.open { opacity: 1; }

    :focus-visible { outline: 3px solid rgba(255,121,0,0.18); outline-offset: 4px; }

    .scroll-progress {
      transform: translateY(calc((1 - var(--progress, 0)) * 16px));
      opacity: var(--progress, 0);
      transition: transform .2s linear, opacity .2s linear;
    }

    @media (max-width: 767px) {
      .hero-inner { padding: 0 2rem; }
      .hero-bg { opacity: .45; }
    }
  </style>
</head>

<body class="bg-black text-gray-200 font-sans selection:bg-orange-500 selection:text-black">
  <div id="scrollProgress" aria-hidden="true" style="position:fixed;left:0;top:0;height:3px;background:#ff7900;width:0;z-index:60"></div>

<header class="sticky top-0 z-50 bg-black/90 backdrop-blur border-b border-white/10 revealed">
  <div class="max-w-7xl mx-auto flex items-center justify-between px-6 py-4">
    <div class="text-lg sm:text-2xl font-semibold tracking-wide text-orange-500">
      Stories of Amazement
    </div>

    <nav class="hidden md:flex gap-6 text-sm text-gray-300 items-center">
      <a href="#hero" class="nav-link">Home</a>
      <a href="#submit" class="nav-link">Submit</a>
      <a href="#stories" class="nav-link">About</a>
      <a href="#archive" class="nav-link">Archive</a>
      <input
        type="search"
        placeholder="Search stories..."
        class="hidden lg:block bg-white/5 border border-white/10 rounded-lg px-4 py-1.5 text-sm placeholder-gray-500 focus:outline-none focus:border-orange-500 ml-4"
        aria-label="Search stories"
      />
    </nav>

    <div class="md:hidden flex items-center gap-3">
      <button id="mobileMenuBtn" aria-expanded="false" aria-controls="mobileNav" class="p-2 rounded-md text-gray-200 hover:bg-white/5 focus:outline-none focus-visible:ring-2 focus-visible:ring-orange-300" aria-label="Open menu">
        <svg width="20" height="14" viewBox="0 0 20 14" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
          <rect width="20" height="2" rx="1" fill="currentColor"></rect>
          <rect y="6" width="20" height="2" rx="1" fill="currentColor"></rect>
          <rect y="12" width="20" height="2" rx="1" fill="currentColor"></rect>
        </svg>
      </button>
    </div>
  </div>

  <div id="mobileNav" class="px-6 pb-4 md:hidden bg-black/95 border-t border-white/5 hidden">
    <div class="flex flex-col gap-3 text-sm">
      <a href="#hero" class="nav-link block py-2">Home</a>
      <a href="#submit" class="nav-link block py-2">Submit</a>
      <a href="#stories" class="nav-link block py-2">About</a>
      <a href="#archive" class="nav-link block py-2">Archive</a>
    </div>
  </div>
</header>

<section id="hero" class="relative min-h-[75vh] md:min-h-[85vh] flex items-center justify-center overflow-hidden">
  <img
    src="media/hero_hands.png"
    alt="Two hands reaching towards each other in warm light"
    class="hero-bg absolute inset-0 w-full h-full object-cover opacity-40 scale-[1.02] will-change-transform"
    aria-hidden="true"
  />
  <div class="relative z-10 text-center max-w-2xl px-6 hero-inner">
    <h1 id="heroTitle" class="text-3xl sm:text-4xl md:text-6xl font-semibold tracking-tight mb-4">
      <span data-typed="Cook. Create. Connect." aria-live="polite"></span>
    </h1>
    <p class="text-base sm:text-lg text-gray-300 mb-6">
      Small moments of wonder. Shared without hurry.
    </p>
    <a href="#stories" class="btn" id="enterBtn">Enter</a>
  </div>
</section>

<section id="stories" class="max-w-6xl mx-auto px-6 py-12 md:py-16">
  <h2 class="text-2xl md:text-3xl font-semibold mb-8 text-center">
    Paivepo
    <span class="block w-16 h-1 bg-orange-500 mx-auto mt-3"></span>
  </h2>

  <div class="space-y-6">
    <article class="bg-white/5 border border-white/10 rounded-2xl p-5 md:p-8 reveal scroll-progress" data-stagger="1" tabindex="0">
      <h3 class="text-lg md:text-xl font-semibold mb-2">
        From Dhivha Dollar to Cadence Chitsa
      </h3>
      <p class="text-sm text-gray-400 mb-2">
        A Story of Amazement by ZZ · Story · Published today
      </p>
      <p class="text-sm text-gray-300 mb-3">
        Once, we trusted men in overcoats and chaos, bus conductors like Dhivha Dollar whose name was both a joke and hope. Today the paper is gone, but the faith remains.
      </p>

      <div id="dhivha-full" class="text-sm text-gray-300 space-y-3 mt-3 hidden">
        <p><strong>Then: Dhivha's Road</strong><br>Once, we trusted men in overcoats and chaos, bus conductors like Dhivha Dollar, whose name was both a joke and a hope. You would slip your child's school fees into an envelope, fold your prayers into it, and hand it over. The rest was faith. Today, the paper is gone. But the faith remains.</p>
        <p><strong>A Mother's Midnight Plea</strong><br>Predawn. Harare. Silence, then the sharp bark of a dog. A phone buzzes. A mother stirs. "ZWG 4,050 needed before 7am." Her son's university registration hangs on that sum. A first generation dream, one deadline away from slipping. In Esigodhini, a cousin empties her OneMoney. In Seke, ambuya's balance moves instantly. In Mkoba, an aunt at her tuckshop hesitates, then sends what she can, picturing his graduation. By sunrise, the bank message arrives. ZWG 4,050 received. The mother exhales, phone pressed to her cheek. A digital prayer answered.</p>
        <p><strong>Rise: The Market That Never Sleeps</strong><br>As the sun climbs over Mbare Musika, the market hums. Tomatoes gleam. Voices rise. Phones buzz. At Mai Two's stall, money moves in silence. Customers pay through apps, QR and USSD. Her balance grows with each tomato gone. By sundown, she has enough for her toddler's favourite snack. She walks home past Rufaro Stadium with nothing in her handbag but peace of mind. No fear. No bundles of cash. Just numbers and trust.</p>
        <p><strong>Hope: A Hospital Ward Glows</strong><br>Night. Chitungwiza Hospital. Betty's thumb hovers over the family group: "Mhamha's surgery prep - $50 short." In Warren Park, a brother half wakes, sends money via Blue247. In Sakubva, an aunt chips in from her chicken project. Seconds later, Betty texts: "Zvaita. Thank you, vanhuVashe." She slumps against the cold tile, warmed by the buzz of connection. Not just the network. The people.</p>
        <p><strong>Grief: Gokwe's Final Gathering</strong><br>The next day, in Gokwe, a funeral is planned. The WhatsApp group flares: "US$500 needed for burial." From across the nation, money trickles in. Transfers. Each amount small. Together, enough. By noon, the coffin is lowered with dignity. Not because people had much. But because they shared what they had. It is not just money. It is a promise. We show up for each other.</p>
        <p><strong>The Thread That Holds Us</strong><br>We used to trust the road. Now we trust the invisible. Where once Dhivha Dollar ran with notes tucked in socks, now ZIPIT sends money from farm to flat, stall to surgery. In seconds. It is not flashy. It is not loud. It is survival turned seamless, a revolution disguised as routine.</p>
        <p><strong>This Is How We Rise</strong><br>Every transaction is a leap of faith. Every transfer is more than money. It is sacrifice. It is hope. It is a whispered vow that we are in this together. We have always made a plan to survive. Now, through financial flexibility, we begin to thrive.</p>
        <p><strong>Meet the Connectors</strong><br>Behind every transfer, there is a story. And behind every story, someone like David Chitsa. David has worked in Zimswitch customer service for decades. He has answered late night calls, solved frozen transfers and calmed frantic voices. He does not just solve problems. He restores connection. People do not remember the app. They remember the person who helped them hold the line.</p>
      </div>

      <button
        id="dhivha-toggle"
        type="button"
        class="mt-2 text-orange-400 text-sm font-medium hover:text-orange-300 focus-visible:underline"
        onclick="toggleDhivha()"
        aria-expanded="false"
        aria-controls="dhivha-full">
        Read more
      </button>
    </article>

    <article class="bg-white/5 border border-white/10 rounded-2xl p-5 md:p-8 reveal scroll-progress" data-stagger="2" tabindex="0">
      <h3 class="text-lg md:text-xl font-semibold mb-2">
        Learner-ed Tembo
      </h3>
      <p class="text-sm text-gray-400 mb-2">
        Chronicles of growth and discovery · Story · Pending
      </p>
      <p class="text-sm text-gray-300 mb-4">
        A quiet archive of experiments, lessons and gentle failures. This space is reserved for the unfolding notes of Learner-ed Tembo, once they are ready to be shared.
      </p>
      <span class="text-gray-500 text-xs">
        Coming soon
      </span>
    </article>
  </div>
</section>

<section id="gallery" class="max-w-6xl mx-auto px-6 py-12 md:py-20">
  <h2 class="text-2xl md:text-3xl font-semibold mb-8 text-center">
    Picasso's Playground
    <span class="block w-16 h-1 bg-orange-500 mx-auto mt-3"></span>
  </h2>

  <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
    <div class="reveal" data-stagger="1">
      <img
        src="media/shoreline_silence.png"
        alt="Calm shoreline at dawn reflecting pastel sky"
        class="rounded-xl mb-4 w-full h-64 object-cover cursor-pointer blur-up"
        onclick="openLightbox('media/shoreline_silence.png','Vivid Views')"
        loading="lazy"
      />
      <h3 class="text-lg font-medium mb-1">Vivid Views</h3>
      <p class="text-gray-400 text-sm">Presence, not performance.</p>
    </div>

    <div class="reveal" data-stagger="2">
      <img
        src="media/open_horizon.png"
        alt="A wide seascape with an open sky and calm sea"
        class="rounded-xl mb-4 w-full h-64 object-cover cursor-pointer blur-up"
        onclick="openLightbox('media/open_horizon.png','Love and Life')"
        loading="lazy"
      />
      <h3 class="text-lg font-medium mb-1">Love and Life</h3>
      <p class="text-gray-400 text-sm">Space to breathe inside the moment.</p>
    </div>

    <div class="reveal" data-stagger="3">
      <img
        src="media/candle_circle.png"
        alt="A warm candle circle in darkness"
        class="rounded-xl mb-4 w-full h-64 object-cover cursor-pointer blur-up"
        onclick="openLightbox('media/candle_circle.png','Ritual')"
        loading="lazy"
      />
      <h3 class="text-lg font-medium mb-1">Ritual</h3>
      <p class="text-gray-400 text-sm">Light holding the dark.</p>
    </div>

    <div class="reveal" data-stagger="4">
      <img
        src="media/city_crosswalk.png"
        alt="People crossing with an orange umbrella at night"
        class="rounded-xl mb-4 w-full h-64 object-cover cursor-pointer blur-up"
        onclick="openLightbox('media/city_crosswalk.png','Passing Through')"
        loading="lazy"
      />
      <h3 class="text-lg font-medium mb-1">Passing Through</h3>
      <p class="text-gray-400 text-sm">We cross paths more than we realise.</p>
    </div>
  </div>
</section>

<section class="max-w-6xl mx-auto px-6 py-10 md:py-16">
  <h2 class="text-2xl md:text-3xl font-semibold mb-3 text-center">
    Mulberry Music
    <span class="block w-16 h-1 bg-orange-500 mx-auto mt-3"></span>
  </h2>
  <p class="text-center text-gray-400 mb-8">
    Playlists for late night reflection, slow mornings and small domestic miracles.
  </p>

  <div class="grid gap-6 md:grid-cols-2">
    <div class="playlist-card rounded-2xl bg-black/40 overflow-hidden reveal" style="min-height:180px;" data-stagger="1">
      <div class="iframe-skeleton" aria-hidden="true"></div>
      <iframe
        src="https://open.spotify.com/embed/playlist/24V7Kz8fiT75iZ7GV782ze"
        width="100%" height="380" frameborder="0"
        allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"
        loading="lazy" class="w-full" title="Playlist: Late Night Reflection"></iframe>
    </div>

    <div class="playlist-card rounded-2xl bg-black/40 overflow-hidden reveal" style="min-height:180px;" data-stagger="2">
      <div class="iframe-skeleton" aria-hidden="true"></div>
      <iframe
        src="https://open.spotify.com/embed/playlist/0tM0unRHtx4J3McyQDvLHr"
        width="100%" height="380" frameborder="0"
        allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"
        loading="lazy" class="w-full" title="Playlist: Slow Mornings"></iframe>
    </div>
  </div>
</section>

<section id="archive" class="bg-black py-12 md:py-16">
  <div class="max-w-6xl mx-auto px-6">
    <h2 class="text-2xl md:text-3xl font-semibold mb-8 text-center">
      Thrifted Threads
      <span class="block w-16 h-1 bg-orange-500 mx-auto mt-3"></span>
    </h2>

    <article class="max-w-4xl mx-auto bg-white/5 border border-white/10 rounded-2xl overflow-hidden reveal" data-stagger="1">
      <img
        src="media/tinopfeka_tsiki.png"
        alt="Tinopfeka Tsiki fashion piece"
        class="w-full h-[360px] object-cover blur-up"
        loading="lazy"
      />
      <div class="px-6 py-5">
        <h3 class="text-lg font-semibold mb-1">Tinopfeka Tsiki</h3>
        <p class="text-gray-400 text-sm">
          Struggle meets unrelenting perseverance.
        </p>
      </div>
    </article>
  </div>
</section>

<section id="submit" class="bg-white/5 py-12 md:py-20">
  <div class="max-w-xl mx-auto px-6 text-center">
    <img
      src="media/submit_cassette.png"
      alt="Cassette tape metaphor for story submission"
      class="w-28 mx-auto mb-6 opacity-80 blur-up"
      loading="lazy"
    />

    <h2 class="text-xl md:text-2xl font-semibold mb-4">Submit Your Story</h2>
    <p class="text-gray-400 mb-6">
      Got an imperfect thought, a quiet moment, a memory worth pausing on?
    </p>

    <a href="#" class="btn">Share</a>
  </div>
</section>

<footer class="border-t border-white/10 mt-12">
  <div class="max-w-7xl mx-auto px-6 py-8 flex flex-col md:flex-row justify-between items-center gap-4 text-sm text-gray-500">
    <span>© <span id="year"></span> Stories of Amazement</span>
    <span>Made with quiet intention.</span>
  </div>
</footer>

<div id="lightbox"
     class="fixed inset-0 bg-black/90 hidden items-center justify-center z-50"
     onclick="closeLightbox()" role="dialog" aria-modal="true" aria-hidden="true">
  <img id="lightbox-img" class="max-w-[90vw] max-h-[90vh] rounded-xl shadow-2xl opacity-0 transition-opacity duration-200">
</div>

<script>
  const $ = (sel, root = document) => root.querySelector(sel);
  const $$ = (sel, root = document) => Array.from(root.querySelectorAll(sel));

  document.getElementById("year").textContent = new Date().getFullYear();

  (function setupMobileNav(){
    const btn = document.getElementById('mobileMenuBtn');
    const panel = document.getElementById('mobileNav');
    if (!btn || !panel) return;
    btn.addEventListener('click', () => {
      const open = panel.classList.toggle('open');
      btn.setAttribute('aria-expanded', open ? 'true' : 'false');
      panel.classList.toggle('hidden', !open);
    });
    panel.addEventListener('click', (e) => {
      if (e.target.tagName === 'A') {
        panel.classList.remove('open');
        panel.classList.add('hidden');
        btn.setAttribute('aria-expanded', 'false');
      }
    });
  })();

  (function lightboxInit(){
    const lightbox = document.getElementById('lightbox');
    const img = document.getElementById('lightbox-img');

    function open(src, title){
      img.style.opacity = 0;
      img.src = src;
      img.alt = title || '';
      lightbox.classList.remove('hidden');
      lightbox.classList.add('open','flex');
      document.body.style.overflow = 'hidden';
      lightbox.setAttribute('aria-hidden', 'false');
      img.onload = () => { img.classList.add('img-loaded'); img.style.opacity = 1; };
      img.onerror = () => { img.style.opacity = 1; };
      document.addEventListener('keydown', onKey);
    }

    function close(){
      lightbox.classList.remove('open','flex');
      lightbox.classList.add('hidden');
      document.body.style.overflow = '';
      lightbox.setAttribute('aria-hidden', 'true');
      document.removeEventListener('keydown', onKey);
      img.src = '';
      img.classList.remove('img-loaded');
    }

    function onKey(e){
      if (e.key === 'Escape') close();
    }

    window.openLightbox = open;
    window.closeLightbox = close;
  })();

  function toggleDhivha(){
    const full = document.getElementById('dhivha-full');
    const btn = document.getElementById('dhivha-toggle');
    if (!full || !btn) return;
    const isHidden = full.classList.contains('hidden');
    if (isHidden) {
      full.classList.remove('hidden');
      btn.textContent = 'Read less';
      btn.setAttribute('aria-expanded','true');
    } else {
      full.classList.add('hidden');
      btn.textContent = 'Read more';
      btn.setAttribute('aria-expanded','false');
    }
  }

  (function typewriterInit(){
    const prefersReduce = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
    const span = $('#heroTitle span[data-typed]');
    if (!span) return;
    const fullText = span.getAttribute('data-typed') || '';
    if (prefersReduce) {
      span.textContent = fullText;
      return;
    }
    span.textContent = '';
    let i = 0;
    function step(){
      if (i <= fullText.length) {
        span.textContent = fullText.slice(0, i);
        const ch = fullText[i - 1];
        const delay = ch === '.' ? 420 : 90;
        i++;
        setTimeout(step, delay);
      }
    }
    step();
  })();

  (function parallaxInit(){
    const hero = document.getElementById('hero');
    const img = hero ? hero.querySelector('.hero-bg') : null;
    if (!hero || !img) return;
    const prefersReduce = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
    const isTouch = ('ontouchstart' in window) || navigator.maxTouchPoints > 0;
    if (prefersReduce || isTouch) return;

    let mouseX = 0, mouseY = 0;
    let targetX = 0, targetY = 0;
    let ticking = false;

    hero.addEventListener('mousemove', (e) => {
      const rect = hero.getBoundingClientRect();
      mouseX = ((e.clientX - rect.left) / rect.width - 0.5) * 2;
      mouseY = ((e.clientY - rect.top) / rect.height - 0.5) * 2;
      requestTick();
    });

    hero.addEventListener('mouseleave', () => {
      mouseX = 0;
      mouseY = 0;
      requestTick();
    });

    function requestTick(){ if (!ticking){ requestAnimationFrame(update); ticking = true; } }

    function update(){
      targetX += (mouseX - targetX) * 0.12;
      targetY += (mouseY - targetY) * 0.12;
      const translateX = targetX * 8;
      const translateY = targetY * 6;
      const scale = 1.04 + Math.abs(targetX + targetY) * 0.006;
      img.style.transform = `scale(${scale}) translate(${translateX}px, ${translateY}px)`;
      ticking = false;
    }
  })();

  (function revealInit(){
    const prefersReduce = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
    const reveals = $$('.reveal');
    const blurs = $$('.blur-up');

    const observerOpts = { threshold: 0.12 };
    if (!prefersReduce) {
      const io = new IntersectionObserver((entries, obs) => {
        entries.forEach((entry) => {
          if (!entry.isIntersecting) return;
          const el = entry.target;
          const staggerIndex = el.dataset.stagger ? parseInt(el.dataset.stagger, 10) : 0;
          if (!isNaN(staggerIndex) && staggerIndex > 0) {
            el.style.transitionDelay = `${staggerIndex * 60}ms`;
          }
          el.classList.add('is-visible');
          obs.unobserve(el);
        });
      }, observerOpts);
      reveals.forEach((r) => io.observe(r));
    } else {
      reveals.forEach(r => r.classList.add('is-visible'));
    }

    blurs.forEach(img => {
      if (img.complete && img.naturalWidth !== 0) {
        img.classList.add('img-loaded');
      } else {
        img.addEventListener('load', () => img.classList.add('img-loaded'), { once: true });
      }
    });
  })();

  (function iframeSkeleton(){
    const iframes = Array.from(document.querySelectorAll('iframe'));
    iframes.forEach(frame => {
      const parent = frame.closest('.playlist-card');
      if (!parent) return;
      const skeleton = parent.querySelector('.iframe-skeleton');
      let cleaned = false;
      function remove(){
        if (cleaned) return;
        cleaned = true;
        if (skeleton) skeleton.remove();
      }
      frame.addEventListener('load', remove, { once: true });
      setTimeout(remove, 4000);
    });
  })();

  (function smallUX(){
    if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
      try { document.documentElement.style.scrollBehavior = 'smooth'; } catch(e){}
    }

    document.addEventListener('click', function(e){
      const nav = document.getElementById('mobileNav');
      const btn = document.getElementById('mobileMenuBtn');
      if (!nav || !btn) return;
      if (nav.classList.contains('open')) {
        if (!nav.contains(e.target) && !btn.contains(e.target)) {
          nav.classList.remove('open');
          nav.classList.add('hidden');
          btn.setAttribute('aria-expanded','false');
        }
      }
    }, { passive: true });
  })();

  (function galleryKeyboard() {
    const items = Array.from(document.querySelectorAll('#gallery img'));
    items.forEach(img => {
      img.tabIndex = 0;
      img.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          const src = img.getAttribute('src');
          const title = img.getAttribute('alt') || '';
          window.openLightbox(src, title);
        }
      });
    });
  })();

  (function scrollProgressInit() {
    if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) return;
    const bar = document.getElementById('scrollProgress');
    if (!bar) return;

    let ticking = false;

    function update() {
      const doc = document.documentElement;
      const scroll = doc.scrollTop || document.body.scrollTop;
      const height = doc.scrollHeight - doc.clientHeight;
      const pct = height ? (scroll / height) : 0;
      bar.style.width = `${Math.round(pct * 100)}%`;
      ticking = false;
    }

    window.addEventListener('scroll', () => {
      if (!ticking) {
        requestAnimationFrame(update);
        ticking = true;
      }
    }, { passive: true });

    update();
  })();

  (function headerScrollHide() {
    const header = document.querySelector('header');
    if (!header) return;

    let lastY = window.scrollY;
    let ticking = false;

    function onScroll() {
      const y = window.scrollY;
      const delta = y - lastY;
      if (Math.abs(delta) < 8) {
        ticking = false;
        return;
      }
      if (y > lastY && y > 120) {
        header.classList.add('hidden-up');
        header.classList.remove('revealed');
      } else {
        header.classList.remove('hidden-up');
        header.classList.add('revealed');
      }
      lastY = y;
      ticking = false;
    }

    window.addEventListener('scroll', () => {
      if (!ticking) {
        requestAnimationFrame(onScroll);
        ticking = true;
      }
    }, { passive: true });
  })();

  (function scrollProgressCards() {
    const els = Array.from(document.querySelectorAll('.scroll-progress'));
    if (!els.length) return;

    function setProgressFor(elem) {
      const rect = elem.getBoundingClientRect();
      const full = window.innerHeight + rect.height;
      const visible = Math.min(Math.max((window.innerHeight - rect.top) / full, 0), 1);
      elem.style.setProperty('--progress', visible.toFixed(3));
    }

    let ticking = false;
    function updateAll() {
      els.forEach(setProgressFor);
      ticking = false;
    }

    window.addEventListener('scroll', () => {
      if (!ticking) {
        requestAnimationFrame(updateAll);
        ticking = true;
      }
    }, { passive: true });

    window.addEventListener('resize', () => {
      requestAnimationFrame(updateAll);
    }, { passive: true });

    updateAll();
  })();

  window.addEventListener('DOMContentLoaded', function () {
    // hook left open for any extra DOM ready work if needed later
  });
</script>

</body>
</html>
